<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav ul li a { background-image: none; } .site-nav > ul.nav-category-list > li > button svg { transform: rotate(-90deg); } .site-nav > ul.nav-category-list > li.nav-list-item > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Building a VirtualBox Home Lab: Secure Network Topology Part 1 | Home</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Building a VirtualBox Home Lab: Secure Network Topology Part 1" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Network &amp; Security Home Lab:" /> <meta property="og:description" content="Network &amp; Security Home Lab:" /> <link rel="canonical" href="https://sigsandor.github.io/security/2024-07-05-homelabpart10/" /> <meta property="og:url" content="https://sigsandor.github.io/security/2024-07-05-homelabpart10/" /> <meta property="og:site_name" content="Home" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-07-05T00:00:00-04:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Building a VirtualBox Home Lab: Secure Network Topology Part 1" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-07-05T00:00:00-04:00","datePublished":"2024-07-05T00:00:00-04:00","description":"Network &amp; Security Home Lab:","headline":"Building a VirtualBox Home Lab: Secure Network Topology Part 1","mainEntityOfPage":{"@type":"WebPage","@id":"https://sigsandor.github.io/security/2024-07-05-homelabpart10/"},"url":"https://sigsandor.github.io/security/2024-07-05-homelabpart10/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Home </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/CHANGELOG.html" class="nav-list-link">Changelog</a></li></ul> <div class="nav-category">Security</div> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Network & Security Home Lab category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/security/2024-05-15-homelabpart1/" class="nav-list-link">Network & Security Home Lab</a><ul class="nav-list"><li class="nav-list-item"><a href="/security/2024-05-16-homelabpart2/" class="nav-list-link">Part 2 - pfSense Setup & Configuration</a></li><li class="nav-list-item"><a href="/security/2024-05-16-homelabpart3/" class="nav-list-link">Part 3 - Parrot Security (Linux setup)</a></li><li class="nav-list-item"><a href="/security/2024-05-16-homelabpart4/" class="nav-list-link">Part 4 - pfSense Firewall configuration</a></li><li class="nav-list-item"><a href="/security/2024-07-04-homelabpart5/" class="nav-list-link">Part 5 - Cyber Range setup</a></li><li class="nav-list-item"><a href="/security/2024-07-15-homelabpart6/" class="nav-list-link">Part 6 - Active Directory Setup</a></li></ul></li><li class="nav-list-item"><a href="/security/2024-5-26-DMARC/" class="nav-list-link">Email Authentication: DMARC</a></li><li class="nav-list-item"><a href="/security/2024-06-18-KQLbasics/" class="nav-list-link">KQL basics</a></li><li class="nav-list-item"><a href="/security/2022-05-19-links/" class="nav-list-link">Useful Cybersecurity links</a></li></ul> <div class="nav-category">Networking</div> <ul class="nav-list"><li class="nav-list-item"><a href="/networking/2024-06-22-NetworkingProtocols/" class="nav-list-link">Networking 101</a></li></ul> <div class="nav-category">Personal</div> <ul class="nav-list"><li class="nav-list-item"><a href="/personal/2020-05-21-dusunre/" class="nav-list-link">Online History</a></li><li class="nav-list-item"><a href="/personal/2024-05-16-explorepics/" class="nav-list-link">Photo collection</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Home" aria-label="Search Home" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://www.linkedin.com/in/alex-barkman-b7b26a186/" class="site-button" > Linkedin </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/sigSandor" class="site-button" > Github </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/security/2024-05-15-homelabpart1/">Network & Security Home Lab</a></li> <li class="breadcrumb-nav-list-item"><span>Building a VirtualBox Home Lab: Secure Network Topology Part 1</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 id="network--security-home-lab"> <a href="#network--security-home-lab" class="anchor-heading" aria-labelledby="network--security-home-lab"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network &amp; Security Home Lab: </h2> <h3 id="part-1---secure-network-topology"> <a href="#part-1---secure-network-topology" class="anchor-heading" aria-labelledby="part-1---secure-network-topology"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: pink; font-weight: bold;">Part 1 - Secure Network Topology</span> </h3> <p><img src="/assets/banner.jpg" alt="banner" width="auto" height="auto" /></p> <h6 id="posted-may-15-2024"> <a href="#posted-may-15-2024" class="anchor-heading" aria-labelledby="posted-may-15-2024"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Posted <strong><em>May 15, 2024</em></strong> </h6> <p>Building a Virtual Security Home Lab: Part 10 - Splunk Setup &amp; Configuration</p> <p>Banner Background by logturnal on Freepik Hacker Image by catalyststuff on Freepik</p> <p>In this module, we will set up Splunk (SIEM) in a Ubuntu VM. The VM will be added to the SECURITY subnet. Then we will configure Splunk Universal Forwarder on our Windows Server 2019 (DC) VM which will allow Splunk to ingest logs from the DC.</p> <h2 id="ubuntu-setup"> <a href="#ubuntu-setup" class="anchor-heading" aria-labelledby="ubuntu-setup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Ubuntu Setup</span> </h2> <h3 id="downloading-the-image"> <a href="#downloading-the-image" class="anchor-heading" aria-labelledby="downloading-the-image"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading the Image </h3> <p>Go to the following URL: Download Ubuntu Desktop | Download | Ubuntu. Download the latest LTS version of Ubuntu. As of writing the latest version is 2022.04.3</p> <p>The ISO is ~5GB.</p> <p>After the download is complete you will have a .iso file.</p> <h3 id="creating-the-vm"> <a href="#creating-the-vm" class="anchor-heading" aria-labelledby="creating-the-vm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating the VM </h3> <p>In VirtualBox from the sidebar select Tools and then click on New from the toolbar.</p> <p>Give the VM a name. Select the downloaded ISO image. Select the “Skip Unattended Installation” option and click on Next.</p> <p>Increase the Base Memory to 4096MB (4GB) and click on Next.</p> <p>Increase the Hard Disk size to 100GB and click on Next.</p> <p>Confirm that all the settings look correct and click on Finish.</p> <h3 id="adding-vm-to-group"> <a href="#adding-vm-to-group" class="anchor-heading" aria-labelledby="adding-vm-to-group"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adding VM to Group </h3> <p>Right-click the VM and select “Move to Group” then choose Home Lab/Security.</p> <p>The final result should look as follows:</p> <h3 id="configuring-the-vm"> <a href="#configuring-the-vm" class="anchor-heading" aria-labelledby="configuring-the-vm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring the VM </h3> <p>Select the VM and click on Settings from the toolbar.</p> <p>Go to System -&gt; Motherboard. In Boot Order ensure that Hard Disk is on the top followed by Optical. Uncheck Floppy.</p> <p>Go to Network -&gt; Adapter 1. For the Attached to field select Internal Network. For name select LAN 4. Click on OK to save changes.</p> <h2 id="installing-ubuntu"> <a href="#installing-ubuntu" class="anchor-heading" aria-labelledby="installing-ubuntu"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Installing Ubuntu</span> </h2> <p>Select the VM and click on Start.</p> <p>Press Enter to start the Graphical Installer.</p> <p>Select your language and click on “Install Ubuntu”.</p> <p>Select Keyboard Layout and click on Continue.</p> <p>Enable “Install third-party software for graphics and Wi-Fi hardware and additional media formats” and click on Continue.</p> <p>Click on Install Now.</p> <p>Click on Continue.</p> <p>Select your location and click on Continue.</p> <p>Enter the username, password and hostname and click on Continue.</p> <p>Click on Restart Now to boot into the system.</p> <p>VirtualBox will automatically remove the ISO file from the disk drive. Press Enter to boot into the newly installed system.</p> <p>Login using your password.</p> <p>Complete the post-install setup as shown. Click on Skip.</p> <p>Click on Next.</p> <p>Select “No, don’t send system info” and click on Next.</p> <p>Ensure this setting is disabled and click on Next.</p> <p>Click on Done to close the wizard.</p> <h2 id="post-install-configuration"> <a href="#post-install-configuration" class="anchor-heading" aria-labelledby="post-install-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Post-Install Configuration</span> </h2> <h3 id="install-guest-additions"> <a href="#install-guest-additions" class="anchor-heading" aria-labelledby="install-guest-additions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Install Guest Additions </h3> <p>From the VM toolbar select Devices -&gt; Install Guest Additions CD image.</p> <p>The disk will show up on the dock. Click on it to view the content of the disk.</p> <p>Right-click anywhere in the empty area in the File Explorer and select “Open in Terminal”.</p> <p>Run the following command to install Guest Additions:</p> <p>sudo ./VBoxLinuxAdditions.run</p> <p>Once the installation is complete close the terminal, right-click on the disk icon in the dock and select Eject.</p> <h3 id="installing-updates"> <a href="#installing-updates" class="anchor-heading" aria-labelledby="installing-updates"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installing Updates </h3> <p>Press Ctrl+Alt+T to open a new terminal then enter the following command to update the system:</p> <p>sudo apt update &amp;&amp; sudo apt full-upgrade</p> <p>Enter your password when prompted. If there are updates press Enter to start the install.</p> <h3 id="creating-vm-snapshot"> <a href="#creating-vm-snapshot" class="anchor-heading" aria-labelledby="creating-vm-snapshot"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating VM Snapshot </h3> <p>Shut down the VM. Click on the Hamburger menu beside the VM name and select Snapshots.</p> <p>Click on Take to create a Snapshot.</p> <p>Provide a descriptive name and click on OK.</p> <p>Click on the Hamburger menu and click on “Details” to return to the main page.</p> <h2 id="splunk-installation"> <a href="#splunk-installation" class="anchor-heading" aria-labelledby="splunk-installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Splunk Installation</span> </h2> <h3 id="splunk-download"> <a href="#splunk-download" class="anchor-heading" aria-labelledby="splunk-download"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Splunk Download </h3> <p>On the Ubuntu VM go to the following URL: Splunk Enterprise Free Trial | Splunk As of writing the latest version of Splunk Enterprise is 9.1.2.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>To download Splunk you have to create a account.
Link to get v9.1.2 without an account has been provided at the end of this section.
If you want to use the latest version follow the steps below to create a account.
</code></pre></div></div> <p>Fill in the details in the form, accept the agreement and click on “Create the Account”.</p> <p>After login go to the Linux section and click on the “Download Now” button for the .deb file.</p> <p>Scroll down and accept the agreement and then click on “Access program” to start the download.</p> <p>Alternatively, use the following link to directly download Splunk v9.1.2: Splunk Enterprise 9.1.2 - Linux (.deb) - Direct Download Link</p> <h3 id="splunk-installation-1"> <a href="#splunk-installation-1" class="anchor-heading" aria-labelledby="splunk-installation-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Splunk Installation </h3> <p>Once the download is complete we will have a .deb file. Open the Terminal (Ctrl+Alt+t) and navigate to the Downloads folder.</p> <p>cd Downloads</p> <p>Run the following following command to install curl (dependency for Splunk):</p> <p>sudo apt install curl</p> <p>Enter password when prompted.</p> <p>Run the following command to install Splunk:</p> <p>sudo dpkg -i splunk-9.1.2-b6b9c8185839-linux-2.6-amd64.deb</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If you downloaded the latest version of Splunk the name of the downloaded file could be different from the one shown here. Use the filename that is shown on your system with the above command.
</code></pre></div></div> <p>After the installation is completed use the following command to launch Splunk:</p> <p>sudo /opt/splunk/bin/splunk start –accept-license –answer-yes</p> <p>Provide a name and password when prompted. These credentials need to be used to log into Splunk.</p> <p>Once the setup is complete we see the Splunk is running on http://127.0.0.1:8000</p> <p>Run the following to allow Splunk to start automatically when the system is booted.</p> <p>sudo /opt/splunk/bin/splunk enable boot-start</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>You can choose to ignore the last command to enable auto boot.
If you do not enable run at boot the command that was shown above to start Splunk will need to run to start Splunk.
</code></pre></div></div> <h3 id="creating-vm-snapshot-1"> <a href="#creating-vm-snapshot-1" class="anchor-heading" aria-labelledby="creating-vm-snapshot-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating VM Snapshot </h3> <p>Shut down the VM. Using the Hamburger menu access the Snapshot page. Click on Take to create a Snapshot. Give the Snapshot a descriptive name.</p> <h3 id="splunk-configuration"> <a href="#splunk-configuration" class="anchor-heading" aria-labelledby="splunk-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Splunk Configuration </h3> <p>Before we can install Splunk Universal Forwarder there are a few settings we need to change in Splunk. Open Splunk by going to http://127.0.0.1:8000.</p> <p>From the toolbar select Settings -&gt; Forwarding and receiving.</p> <p>Click on “Add new” in the Receive data section.</p> <p>Enter 9997 as the port to listen for incoming data. Click on Save.</p> <h2 id="universal-forwarder-installation"> <a href="#universal-forwarder-installation" class="anchor-heading" aria-labelledby="universal-forwarder-installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Universal Forwarder Installation</span> </h2> <p>The next steps need to be performed on the Domain Controller (Windows Server 2019). We are going to ingest the log data that is generated by this device into Splunk.</p> <h3 id="universal-forwarder-download"> <a href="#universal-forwarder-download" class="anchor-heading" aria-labelledby="universal-forwarder-download"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Universal Forwarder Download </h3> <div class="table-wrapper"><table> <tbody> <tr> <td>Go to the following link to download Universal Forwarder: Download Universal Forwarder for Remote Data Collection</td> <td>Splunk</td> </tr> </tbody> </table></div> <p>You need to log in to be able to download the setup. Select the Windows tab and then click on the Download Now button beside the 64-bit option.</p> <p>Alternatively, Splunk Universal Forwarder v9.1.2 can be downloaded directly using the following link: Splunk Universal Forwarder 9.1.2 - Windows (.msi) - Direct Download Link</p> <h3 id="universal-forwarder-install"> <a href="#universal-forwarder-install" class="anchor-heading" aria-labelledby="universal-forwarder-install"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Universal Forwarder Install </h3> <p>Double-click on the .msi file to begin installation.</p> <p>Check the box on the top to accept the agreement and then click on Next.</p> <p>Provide a username and password for the Forwarder. I would recommend using the same credentials that were configured on Splunk.</p> <p>For the new step need the IP address of the Ubuntu (Splunk) VM. Use the following command to get the IP address.</p> <p>ip a</p> <p>Use the IP address that is shown under enp0s3.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If in your case instead of enp0s3 you see eth0 use the IP address that is shown under that section.
</code></pre></div></div> <p>Enter the IP address of the Splunk VM (in my case 10.10.10.13) and enter 8089 as the value for the port field then click on Next.</p> <p>Again enter the Splunk VM IP address and for port enter 9997. This is the port we configured in Splunk. Click on Next to continue.</p> <p>Click on Install.</p> <p>Click on Finish to close the installer.</p> <h2 id="data-ingestion-configuration"> <a href="#data-ingestion-configuration" class="anchor-heading" aria-labelledby="data-ingestion-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Data Ingestion Configuration</span> </h2> <p>Now that we have Splunk and Universal Forwarder configured we need to link both the pieces together so that Splunk can collect data.</p> <h3 id="adding-data-source"> <a href="#adding-data-source" class="anchor-heading" aria-labelledby="adding-data-source"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adding Data Source </h3> <p>In Splunk select Settings -&gt; Add Data.</p> <p>Click on Forward.</p> <p>Our DC VM should automatically show up in the left box. Click on “add all” to move it to the right side. In the “New Source Class Name” field provide a name for the source. Click on Next to continue.</p> <p>Select “Local Event Logs” then click on the “add all” button above the dropdown field to ingest all the logs generated by the DC. Click on Next once done.</p> <p>Click on “Create a new index“.Indexes are the Splunk equivalent of SQL Tables. It is used to store similar data.</p> <p>Provide the Index a name. Keep all the other fields on their default value and click on Save then click on Next.</p> <p>Confirm all the options look correct and click on Submit.</p> <h2 id="querying-data"> <a href="#querying-data" class="anchor-heading" aria-labelledby="querying-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <span style="color: royalblue; font-weight: bold;">Querying Data</span> </h2> <p>From the Splunk toolbar select Apps -&gt; Search &amp; Reporting.</p> <p>In the search box enter the following to view the ingested data:</p> <p>index=”windows”</p> <p>In the above command “windows” is the name I gave my index.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If the search does not return any value, wait for 2-3 minutes and then try again. If there is still no data go to the Windows VM and perform some simple actions (open applications, change settings, etc.) then after sometime you should see data flowing into Splunk.
</code></pre></div></div> <p>In the next module, we will see how we can download files/malware onto the DFIR VM and then move them over to the Malware Analysis lab using SCP.</p> <p><span style="color: royalblue; font-weight: bold;">Part 11 - Transferring Files to Malware Analysis Lab</span></p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
