<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav ul li a { background-image: none; } .site-nav > ul.nav-category-list > li > button svg { transform: rotate(-90deg); } .site-nav > ul.nav-category-list > li.nav-list-item > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Code with line numbers | Home</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="Code with line numbers" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Home" /> <meta property="og:description" content="Home" /> <link rel="canonical" href="https://sigsandor.github.io/docs/ui-components/code/line-numbers/" /> <meta property="og:url" content="https://sigsandor.github.io/docs/ui-components/code/line-numbers/" /> <meta property="og:site_name" content="Home" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Code with line numbers" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Home","headline":"Code with line numbers","url":"https://sigsandor.github.io/docs/ui-components/code/line-numbers/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Home </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/CHANGELOG.html" class="nav-list-link">Changelog</a></li></ul> <div class="nav-category">Security</div> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Network & Security Home Lab category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/security/2024-05-15-homelabpart1/" class="nav-list-link">Network & Security Home Lab</a><ul class="nav-list"><li class="nav-list-item"><a href="/security/2024-05-16-homelabpart2/" class="nav-list-link">Part 2 - pfSense Setup & Configuration</a></li><li class="nav-list-item"><a href="/security/2024-05-16-homelabpart3/" class="nav-list-link">Part 3 - Parrot Security (Linux setup)</a></li><li class="nav-list-item"><a href="/security/2024-05-16-homelabpart4/" class="nav-list-link">Part 4 - pfSense Firewall configuration</a></li><li class="nav-list-item"><a href="/security/2024-07-04-homelabpart5/" class="nav-list-link">Part 5 - Cyber Range setup</a></li><li class="nav-list-item"><a href="/security/2024-07-15-homelabpart6/" class="nav-list-link">Part 6 - Active Directory Setup</a></li></ul></li><li class="nav-list-item"><a href="/security/2024-5-26-DMARC/" class="nav-list-link">Email Authentication: DMARC</a></li><li class="nav-list-item"><a href="/security/2024-06-18-KQLbasics/" class="nav-list-link">KQL basics</a></li><li class="nav-list-item"><a href="/security/2022-05-19-links/" class="nav-list-link">Useful Cybersecurity links</a></li></ul> <div class="nav-category">Networking</div> <ul class="nav-list"><li class="nav-list-item"><a href="/networking/2024-06-22-NetworkingProtocols/" class="nav-list-link">Networking 101</a></li></ul> <div class="nav-category">Personal</div> <ul class="nav-list"><li class="nav-list-item"><a href="/personal/2020-05-21-dusunre/" class="nav-list-link">Online History</a></li><li class="nav-list-item"><a href="/personal/2024-05-16-explorepics/" class="nav-list-link">Photo collection</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Home" aria-label="Search Home" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://www.linkedin.com/in/alex-barkman-b7b26a186/" class="site-button" > Linkedin </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/sigSandor" class="site-button" > Github </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">UI Components</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/ui-components/code.html">Code</a></li> <li class="breadcrumb-nav-list-item"><span>Code with line numbers</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="code-snippets-with-line-numbers"> <a href="#code-snippets-with-line-numbers" class="anchor-heading" aria-labelledby="code-snippets-with-line-numbers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code snippets with line numbers </h1> <p class="warning">In prior versions of the docs, we provided “workarounds” to rendering issues arising from code snippets with line numbers. While these seemed to resolve visual layout issues, they did not resolve core issues with Jekyll generating invalid HTML. See <a href="#detailed-error-explanation">the detailed explanation</a> for more information.</p> <p>The default settings for HTML compression are incompatible with the HTML produced by Jekyll for line numbers from highlighted code – both when using Kramdown code fences and when using Liquid highlight tags.</p> <p>To avoid non-conforming HTML and unsatisfactory layout, HTML compression can be turned off by using the following configuration option:</p> <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">compress_html</span><span class="pi">:</span>
  <span class="na">ignore</span><span class="pi">:</span>
    <span class="na">envs</span><span class="pi">:</span> <span class="s">all</span></code></pre></figure> <p>When using Kramdown code fences, line numbers are turned on globally by the following configuration option:</p> <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">kramdown</span><span class="pi">:</span>
  <span class="na">syntax_highlighter_opts</span><span class="pi">:</span>
    <span class="na">block</span><span class="pi">:</span>
      <span class="na">line_numbers</span><span class="pi">:</span> <span class="kc">true</span></code></pre></figure> <p>Line numbers can then be suppressed locally using Liquid tags (<em>without</em> the <code class="language-plaintext highlighter-rouge">linenos</code> option) instead of fences:</p> <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="pi">{</span><span class="err">%</span> <span class="nv">highlight some_language %</span><span class="pi">}</span>
<span class="s">Some code</span>
<span class="pi">{</span><span class="err">%</span> <span class="nv">endhighlight %</span><span class="pi">}</span></code></pre></figure> <h2 id="detailed-error-explanation"> <a href="#detailed-error-explanation" class="anchor-heading" aria-labelledby="detailed-error-explanation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Detailed Error Explanation </h2> <p>Consider this following code snippet, intended to highlight a simple Ruby program:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% highlight ruby linenos %}
def foo
  puts 'foo'
end
{% endhighlight %}
</code></pre></div></div> <p>If this is directly placed within a file processed by Jekyll (via Just the Docs, with HTML compression enabled), the following markup will be generated:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;figure</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;</span>&gt;<span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-ruby"</span> <span class="na">data-lang=</span><span class="s">"ruby"</span><span class="nt">&gt;&lt;div</span> <span class="na">class=</span><span class="s">"table-wrapper"</span><span class="nt">&gt;&lt;table</span> <span class="na">class=</span><span class="s">"rouge-table"</span><span class="nt">&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td</span> <span class="na">class=</span><span class="s">"gutter gl"</span><span class="nt">&gt;&lt;pre</span> <span class="na">class=</span><span class="s">"lineno"</span><span class="nt">&gt;</span>1
2
3
<span class="nt">&lt;/pre&gt;&lt;td</span> <span class="na">class=</span><span class="s">"code"</span><span class="nt">&gt;&lt;pre&gt;&lt;span</span> <span class="na">class=</span><span class="s">"k"</span><span class="nt">&gt;</span>def<span class="nt">&lt;/span&gt;</span> <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nf"</span><span class="nt">&gt;</span>foo<span class="nt">&lt;/span&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nb"</span><span class="nt">&gt;</span>puts<span class="nt">&lt;/span&gt;</span> <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"s1"</span><span class="nt">&gt;</span>'foo'<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"k"</span><span class="nt">&gt;</span>end<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/pre&gt;&lt;/figure&gt;</span>
</code></pre></div></div> <p>This HTML is invalid; in particular, there are two issues:</p> <ol> <li>there are many missing closing tags, and a superfluous <code class="language-plaintext highlighter-rouge">&gt;</code>, which produce visually garbled output</li> <li>a <code class="language-plaintext highlighter-rouge">&lt;table&gt;</code> is placed within a <code class="language-plaintext highlighter-rouge">&lt;code&gt;</code> element, which is syntactically invalid HTML (but is often allowed by browsers)</li> </ol> <p>To emphasize this first difference, here is the same markup output, indented by tag:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;figure</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;</span>
  &gt;
  <span class="nt">&lt;code</span> <span class="na">class=</span><span class="s">"language-ruby"</span> <span class="na">data-lang=</span><span class="s">"ruby"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"table-wrapper"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"rouge-table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
          <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"gutter gl"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;pre</span> <span class="na">class=</span><span class="s">"lineno"</span><span class="nt">&gt;</span>
1
2
3
              <span class="nt">&lt;/pre&gt;</span>
              <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"code"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;pre&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"k"</span><span class="nt">&gt;</span>def<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nf"</span><span class="nt">&gt;</span>foo<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nb"</span><span class="nt">&gt;</span>puts<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"s1"</span><span class="nt">&gt;</span>'foo'<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"k"</span><span class="nt">&gt;</span>end<span class="nt">&lt;/span&gt;</span>
                <span class="nt">&lt;/pre&gt;</span>
<span class="nt">&lt;/figure&gt;</span>
</code></pre></div></div> <p>In order, there are missing <code class="language-plaintext highlighter-rouge">&lt;/td&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;/td&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;/tr&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;/tbody&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;/table&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;/div&gt;</code>, and <code class="language-plaintext highlighter-rouge">&lt;/code&gt;</code> tags. As a result, the following elements of the page - including the site footer - become visually garbled as browsers attempt to recover gracefully.</p> <p>Prior workarounds we suggested (such as <a href="https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901">Dmitry Hrabrov’s in <code class="language-plaintext highlighter-rouge">jekyll-compress-html</code>#71</a>) resolve the missing tag problem. However, they still place a <code class="language-plaintext highlighter-rouge">&lt;table&gt;</code> within a <code class="language-plaintext highlighter-rouge">&lt;code&gt;</code> element. The HTML spec normatively states that <code class="language-plaintext highlighter-rouge">&lt;code&gt;</code> elements should only contain “<a href="https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2">phrasing content</a>”, which does not include <code class="language-plaintext highlighter-rouge">&lt;table&gt;</code> (<a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-code-element">spec ref</a>). To avoid incorrectly rendered HTML, the previously-suggested workaround using the current version of <code class="language-plaintext highlighter-rouge">_includes/fix_linenos.html</code> should <em>not</em> be used!</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
